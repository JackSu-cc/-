### 领域驱动设计

#### 1.  什么是领域驱动：

> ​       领域驱动设计的英文名称：“Domain-Driven Design”，简称：“DDD”，领域驱动设计是为了解决复杂场景下解决业务问题的一种设计模式，是一套综合业务场景分析和设计的一种建模方法。
>
> ​       最早提出是在2003年，在国内一直不温不火，随着微服务的兴起，DDD逐渐又火热起来了，主要是因为DDD能更好的分离业务复杂度，提高了微服务中每个服务的划分便捷性。
>
> ​       领域驱动设计，是由 **业务专家，开发人员，设计人员**，以共同能理解的 **一种通用语言** 作为交流工具，在交流过程中发现领域的概念，并将这样的概念设计成一个 **领域模型** 。这样一个由领域模型来驱动软件设计的模式，就是“领域驱动设计”。

  #### 2.领域驱动要点：

> * ##### 领域模型 
>
>   领域模型是对某个边界的领域的一个抽象体现，比如货物、书本、用户 等可以是一个领域。
>
>   因为领域模型是由领域专家、开发人员、设计人员共同创造的，与技术无关，更能得到大家的认可，交流更方便。
>
>   领域模型的概念也更加体现出对软件的可维护性。一般使用图表的形式更加清晰的展示出领域的划分。
>
> * #### 统一语言
>
>   因开发人员不懂业务，业务人员不懂技术，沟通的困难，所以需要统一语言，这样更容易沟通。
>
> * #### 领域的概念
>
>   虽然我们明确了要做一个什么样的系统，该系统主要解决什么问题，但是就这样我们还无法开始进行实际的需求分析和模型设计，我们还必须将我们的问题进行拆分，需求进行细化。有些时候，需求方，即提出问题的人，很可能自己不清楚具体想要什么。他只知道一个概念，一个大的目标。比如他只知道要做一个股票交易系统，一个灰度发布系统，一个电商平台，一个开发工具，等。但是他不清楚这些系统应该具体做成什么样子。这个时候，我认为领域专家就非常重要了，DDD也非常强调领域专家的重要性。因为领域专家对这个领域非常了解，对领域内的各种业务场景和各种业务规则也非常清楚，总之，对这个领域内的一切业务相关的知识都非常了解。所以，他们自然就有能力表达出系统该做成什么样子。所以，要知道一个系统到底该做成什么样子，到底哪些是核心业务关注点，只能靠沉淀领域内的各种知识，别无他法。因此，假设你现在打算做一个电商平台，但是你对这个领域没什么了解，那你一定得先去了解下该领域内主流的电商平台，比如淘宝、天猫、京东、亚马逊等。这个了解的过程就是你沉淀领域知识的过程。如果你不了解，就算你领域建模的能力再强，各种技术架构能力再强也是使不上力。领域专家不是某个固定的角色，而是某一类人，这类人对这个领域非常了解。比如，一个开发人员也可以是一个领域专家。假设你在一个公司开发和维护一个系统已经好几年了，但是这个系统的产品经理（PD）可能已经换过好几任了，这种情况下，我相信这几任产品经理都没有比你更熟悉这个领域。
>
> * #### 拆分领域 --细化子域
>
>   有时一个领域往往太复杂，涉及到的领域概念、业务规则、交互流程太多，导致我们没办法直接针对这个大的领域进行领域建模。所以，我们需要将领域进行拆分，本质上就是把大问题拆分为小问题，然后各个击破的思路。然后既然把一个大的领域划分为了多个小的领域（子域），那最关键的就是要理清每个子域的边界；然后要搞清楚哪些子域是核心子域，哪些是非核心子域，哪些是公共支撑子域；然后，还要思考子域之间的联系是什么。那么，我们该如何划分子域呢？我的个人看法是从业务相关性的角度去思考，也就是我们平时说的按业务功能为出发点进行划分。
>
>   1. **梳理领域概念：梳理出领域内我们关注的概念、概念的关系，并统一交流词汇，形成统一语言；**
>   2. **梳理业务规则：梳理出领域内我们关注的各种业务规则，DDD中叫不变性（invariants），比如唯一性规则，余额不能小于零等；**
>   3. **梳理业务场景：梳理出领域内的核心业务场景，比如电商平台中的加入购物车、提交订单、发起付款等核心业务场景；**
>   4. **梳理业务流程：梳理出领域内的关键业务流程，比如订单处理流程，退款流程等；**





### 领域驱动设计架构分层：

1. Presentation Layer：展现层，负责显示和接受输入；
2. Application Layer：应用层，很薄的一层，只包含工作流控制逻辑，不包含业务逻辑；
3. Domain Layer：领域层，包含整个应用的所有业务逻辑；
4. Infrastructure Layer：基础层，提供整个应用的基础服务；